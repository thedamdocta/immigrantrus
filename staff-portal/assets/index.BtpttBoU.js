import{s as X,b as ne}from"./index.BY3x9OSE.js";import{t as S,r as re}from"./index.BUCFnM-n.js";import{p as D}from"./index.DEehm0bc.js";import{p as le}from"./index.COYepv-L.js";import{w as ie}from"./index.D4Wp6AEg.js";import{v as N}from"./index.Wb4bzIyB.js";import{E as se,S as ce}from"./index.BVeNH5zi.js";function oe(e,t){const n=t.properties||{},r=e.all(t),l={type:"link",url:e.resolve(String(n.href||"")||null),title:n.title?String(n.title):null,children:r};return e.patch(t,l),l}function ae(e,t){e.baseFound||(e.frozenBaseUrl=String(t.properties&&t.properties.href||"")||void 0,e.baseFound=!0)}function ue(e,t){const n={type:"blockquote",children:e.toFlow(e.all(t))};return e.patch(t,n),n}function pe(e,t){const n={type:"break"};return e.patch(t,n),n}function he(e){const t=String(e);let n=t.length;for(;n>0;){const r=t.codePointAt(n-1);if(r!==void 0&&(r===10||r===13))n--;else break}return t.slice(0,n)}const T="language-";function x(e,t){const n=t.children;let r=-1,l,i;if(t.tagName==="pre")for(;++r<n.length;){const s=n[r];if(s.type==="element"&&s.tagName==="code"&&s.properties&&s.properties.className&&Array.isArray(s.properties.className)){l=s.properties.className;break}}if(l){for(r=-1;++r<l.length;)if(String(l[r]).slice(0,T.length)===T){i=String(l[r]).slice(T.length);break}}const o={type:"code",lang:i||null,meta:null,value:he(S(t))};return e.patch(t,o),o}function fe(e,t){const n={type:"html",value:"<!--"+t.value+"-->"};return e.patch(t,n),n}function A(e,t){const r={type:"delete",children:e.all(t)};return e.patch(t,r),r}function B(e){let t=-1;if(e.length>1){for(;++t<e.length;)if(e[t].spread)return!0}return!1}function de(e,t){const n=[],r=[];let l=-1;for(;++l<t.children.length;){const s=t.children[l];s.type==="element"&&s.tagName==="div"?n.push(...s.children):n.push(s)}let i={definitions:[],titles:[]};for(l=-1;++l<n.length;){const s=n[l];if(s.type==="element"&&s.tagName==="dt"){const c=n[l-1];c&&c.type==="element"&&c.tagName==="dd"&&(r.push(i),i={definitions:[],titles:[]}),i.titles.push(s)}else i.definitions.push(s)}r.push(i),l=-1;const o=[];for(;++l<r.length;){const s=[...F(e,r[l].titles),...F(e,r[l].definitions)];s.length>0&&o.push({type:"listItem",spread:s.length>1,checked:null,children:s})}if(o.length>0){const s={type:"list",ordered:!1,start:null,spread:B(o),children:o};return e.patch(t,s),s}}function F(e,t){const n=e.all({type:"root",children:t}),r=e.toSpecificContent(n,ge);return r.length===0?[]:r.length===1?r[0].children:[{type:"list",ordered:!1,start:null,spread:B(r),children:r}]}function ge(){return{type:"listItem",spread:!1,checked:null,children:[]}}function k(e,t){const r={type:"emphasis",children:e.all(t)};return e.patch(t,r),r}function R(e){let t=0,n=e.length;for(;t<n&&e[t].type==="break";)t++;for(;n>t&&e[n-1].type==="break";)n--;return t===0&&n===e.length?e:e.slice(t,n)}function g(e,t){const n=Number(t.tagName.charAt(1))||1,r=R(e.all(t)),l={type:"heading",depth:n,children:r};return e.patch(t,l),l}function me(e,t){const n={type:"thematicBreak"};return e.patch(t,n),n}function ye(e,t){const n=t.properties||{},r=String(n.src||""),l=String(n.title||"");if(r&&l){const i={type:"link",title:null,url:e.resolve(r),children:[{type:"text",value:l}]};return e.patch(t,i),i}}function H(e,t){const n=t.properties||{},r={type:"image",url:e.resolve(String(n.src||"")||null),title:n.title?String(n.title):null,alt:n.alt?String(n.alt):""};return e.patch(t,r),r}function w(e,t){const n={type:"inlineCode",value:S(t)};return e.patch(t,n),n}function G(e,t){const n=[],r=[],l=t||e.properties||{},i=J(e),o=Math.min(Number.parseInt(String(l.size),10),0)||(l.multiple?4:1);let s=-1;for(;++s<i.length;){const h=i[s];h&&h.properties&&h.properties.selected&&n.push(h)}const c=n.length>0?n:i,a=Math.min(c.length,o);for(s=-1;++s<a;){const h=c[s],f=h.properties||{},m=S(h),y=m||String(f.label||""),b=String(f.value||"")||m;r.push([b,y===b?void 0:y])}return r}function J(e){const t=[];let n=-1;for(;++n<e.children.length;){const r=e.children[n];"children"in r&&Array.isArray(r.children)&&t.push(...J(r)),r.type==="element"&&r.tagName==="option"&&(!r.properties||!r.properties.disabled)&&t.push(r)}return t}const be="[x]",we="[ ]";function Se(e,t){const n=t.properties||{},r=String(n.value||n.placeholder||"");if(n.disabled||n.type==="hidden"||n.type==="file")return;if(n.type==="checkbox"||n.type==="radio"){const c={type:"text",value:n.checked?e.options.checked||be:e.options.unchecked||we};return e.patch(t,c),c}if(n.type==="image"){const c=n.alt||r;if(c){const a={type:"image",url:e.resolve(String(n.src||"")||null),title:String(n.title||"")||null,alt:String(c)};return e.patch(t,a),a}return}let l=[];if(r)l=[[r,void 0]];else if(n.type!=="button"&&n.type!=="file"&&n.type!=="password"&&n.type!=="reset"&&n.type!=="submit"&&n.list){const c=String(n.list),a=e.elementById.get(c);a&&a.tagName==="datalist"&&(l=G(a,n))}if(l.length===0)return;if(n.type==="password"&&(l[0]=["•".repeat(l[0][0].length),void 0]),n.type==="email"||n.type==="url"){const c=[];let a=-1;for(;++a<l.length;){const h=e.resolve(l[a][0]),f={type:"link",title:null,url:n.type==="email"?"mailto:"+h:h,children:[{type:"text",value:l[a][1]||h}]};c.push(f),a!==l.length-1&&c.push({type:"text",value:", "})}return c}const i=[];let o=-1;for(;++o<l.length;)i.push(l[o][1]?l[o][1]+" ("+l[o][0]+")":l[o][0]);const s={type:"text",value:i.join(", ")};return e.patch(t,s),s}function M(e,t){const{rest:n,checkbox:r}=Y(t),l=r?!!r.properties.checked:null,i=V(n),o=e.toFlow(e.all(n)),s={type:"listItem",spread:i,checked:l,children:o};return e.patch(t,s),s}function V(e){let t=-1,n=!1;for(;++t<e.children.length;){const r=e.children[t];if(r.type==="element"){if(D(r))continue;if(r.tagName==="p"||n||V(r))return!0;n=!0}}return!1}function Y(e){const t=e.children[0];if(t&&t.type==="element"&&t.tagName==="input"&&t.properties&&(t.properties.type==="checkbox"||t.properties.type==="radio")){const n={...e,children:e.children.slice(1)};return{checkbox:t,rest:n}}if(t&&t.type==="element"&&t.tagName==="p"){const{checkbox:n,rest:r}=Y(t);if(n){const l={...e,children:[r,...e.children.slice(1)]};return{checkbox:n,rest:l}}}return{checkbox:void 0,rest:e}}function q(e,t){const n=t.tagName==="ol",r=e.toSpecificContent(e.all(t),ve);let l=null;n&&(l=t.properties&&t.properties.start?Number.parseInt(String(t.properties.start),10):1);const i={type:"list",ordered:n,start:l,spread:B(r),children:r};return e.patch(t,i),i}function ve(){return{type:"listItem",spread:!1,checked:null,children:[]}}const xe={};function ke(e,t){const n=xe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,l=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return Z(e,r,l)}function Z(e,t,n){if(Ne(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return O(e.children,t,n)}return Array.isArray(e)?O(e,t,n):""}function O(e,t,n){const r=[];let l=-1;for(;++l<e.length;)r[l]=Z(e[l],t,n);return r.join("")}function Ne(e){return!!(e&&typeof e=="object")}function C(e){let t=-1;for(;++t<e.length;){const n=e[t];if(!te(n)||"children"in n&&C(n.children))return!0}return!1}function _(e){return ee(e,t,function(n){return n});function t(n){return n.every(function(r){return r.type==="text"?ie(r.value):!1})?[]:[{type:"paragraph",children:R(n)}]}}function Ce(e){return ee(e.children,t,n);function t(r){const l=U(e);return l.children=r,[l]}function n(r){if("children"in r&&"children"in e){const l=U(e),i=U(r);return l.children=r.children,i.children.push(l),i}return{...r}}}function ee(e,t,n){const r=Ie(e),l=[];let i=[],o=-1;for(;++o<r.length;){const s=r[o];te(s)?i.push(s):(i.length>0&&(l.push(...t(i)),i=[]),l.push(n(s)))}return i.length>0&&(l.push(...t(i)),i=[]),l}function Ie(e){const t=[];let n=-1;for(;++n<e.length;){const r=e[n];(r.type==="delete"||r.type==="link")&&C(r.children)?t.push(...Ce(r)):t.push(r)}return t}function te(e){const t=e.data&&e.data.hName;return t?D({type:"element",tagName:t,properties:{},children:[]}):le(e)}function U(e){return X({...e,children:[]})}function j(e,t){const n=t.properties||{},r=t.tagName==="video"?String(n.poster||""):"";let l=String(n.src||""),i=-1,o=!1,s=e.all(t);if(N({type:"root",children:s},function(f){if(f.type==="link")return o=!0,se}),o||C(s))return s;for(;!l&&++i<t.children.length;){const f=t.children[i];f.type==="element"&&f.tagName==="source"&&f.properties&&(l=String(f.properties.src||""))}if(r){const f={type:"image",title:null,url:e.resolve(r),alt:ke(s)};e.patch(t,f),s=[f]}const a=s,h={type:"link",title:n.title?String(n.title):null,url:e.resolve(l),children:a};return e.patch(t,h),h}function P(e,t){const n=R(e.all(t));if(n.length>0){const r={type:"paragraph",children:n};return e.patch(t,r),r}}const Te=['"'];function Ae(e,t){const n=e.options.quotes||Te;e.qNesting++;const r=e.all(t);e.qNesting--;const l=n[e.qNesting%n.length],i=r[0],o=r[r.length-1],s=l.charAt(0),c=l.length>1?l.charAt(1):l;return i&&i.type==="text"?i.value=s+i.value:r.unshift({type:"text",value:s}),o&&o.type==="text"?o.value+=c:r.push({type:"text",value:c}),r}function Me(e,t){let n=e.all(t);(e.options.document||C(n))&&(n=_(n));const r={type:"root",children:n};return e.patch(t,r),r}function qe(e,t){const n=G(t);let r=-1;const l=[];for(;++r<n.length;){const i=n[r];l.push(i[1]?i[1]+" ("+i[0]+")":i[0])}if(l.length>0){const i={type:"text",value:l.join(", ")};return e.patch(t,i),i}}function z(e,t){const r={type:"strong",children:e.all(t)};return e.patch(t,r),r}function L(e,t){const r={type:"tableCell",children:e.all(t)};if(e.patch(t,r),t.properties){const l=t.properties.rowSpan,i=t.properties.colSpan;if(l||i){const o=r.data||(r.data={});l&&(o.hastUtilToMdastTemporaryRowSpan=l),i&&(o.hastUtilToMdastTemporaryColSpan=i)}}return r}function Ue(e,t){const r={type:"tableRow",children:e.toSpecificContent(e.all(t),Be)};return e.patch(t,r),r}function Be(){return{type:"tableCell",children:[]}}function Re(e,t){if(e.inTable){const a={type:"text",value:S(t)};return e.patch(t,a),a}e.inTable=!0;const{align:n,headless:r}=$e(t),l=e.toSpecificContent(e.all(t),W);r&&l.unshift(W());let i=-1;for(;++i<l.length;){const a=l[i],h=e.toSpecificContent(a.children,Fe);a.children=h}let o=1;for(i=-1;++i<l.length;){const a=l[i].children;let h=-1;for(;++h<a.length;){const f=a[h];if(f.data){const m=f.data,y=Number.parseInt(String(m.hastUtilToMdastTemporaryColSpan),10)||1,b=Number.parseInt(String(m.hastUtilToMdastTemporaryRowSpan),10)||1;if(y>1||b>1){let v=i-1;for(;++v<i+b;){let I=h-1;for(;++I<h+y&&l[v];){const $=[];(v!==i||I!==h)&&$.push({type:"tableCell",children:[]}),l[v].children.splice(I,0,...$)}}}"hastUtilToMdastTemporaryColSpan"in f.data&&delete f.data.hastUtilToMdastTemporaryColSpan,"hastUtilToMdastTemporaryRowSpan"in f.data&&delete f.data.hastUtilToMdastTemporaryRowSpan,Object.keys(f.data).length===0&&delete f.data}}a.length>o&&(o=a.length)}for(i=-1;++i<l.length;){const a=l[i].children;let h=a.length-1;for(;++h<o;)a.push({type:"tableCell",children:[]})}let s=n.length-1;for(;++s<o;)n.push(null);e.inTable=!1;const c={type:"table",align:n,children:l};return e.patch(t,c),c}function $e(e){const t={align:[null],headless:!0};let n=0,r=0;return N(e,function(l){if(l.type==="element"){if(l.tagName==="table"&&e!==l)return ce;if((l.tagName==="th"||l.tagName==="td")&&l.properties){if(!t.align[r]){const i=String(l.properties.align||"")||null;(i==="center"||i==="left"||i==="right"||i===null)&&(t.align[r]=i)}t.headless&&n<2&&l.tagName==="th"&&(t.headless=!1),r++}else l.tagName==="thead"?t.headless=!1:l.tagName==="tr"&&(n++,r=0)}}),t}function Fe(){return{type:"tableCell",children:[]}}function W(){return{type:"tableRow",children:[]}}function He(e,t){const n={type:"text",value:t.value};return e.patch(t,n),n}function Oe(e,t){const n={type:"text",value:S(t)};return e.patch(t,n),n}function je(e,t){const n={type:"text",value:"​"};return e.patch(t,n),n}const Pe={comment:fe,doctype:p,root:Me,text:He},ze={applet:p,area:p,basefont:p,bgsound:p,caption:p,col:p,colgroup:p,command:p,content:p,datalist:p,dialog:p,element:p,embed:p,frame:p,frameset:p,isindex:p,keygen:p,link:p,math:p,menu:p,menuitem:p,meta:p,nextid:p,noembed:p,noframes:p,optgroup:p,option:p,param:p,script:p,shadow:p,source:p,spacer:p,style:p,svg:p,template:p,title:p,track:p,abbr:u,acronym:u,bdi:u,bdo:u,big:u,blink:u,button:u,canvas:u,cite:u,data:u,details:u,dfn:u,font:u,ins:u,label:u,map:u,marquee:u,meter:u,nobr:u,noscript:u,object:u,output:u,progress:u,rb:u,rbc:u,rp:u,rt:u,rtc:u,ruby:u,slot:u,small:u,span:u,sup:u,sub:u,tbody:u,tfoot:u,thead:u,time:u,address:d,article:d,aside:d,body:d,center:d,div:d,fieldset:d,figcaption:d,figure:d,form:d,footer:d,header:d,hgroup:d,html:d,legend:d,main:d,multicol:d,nav:d,picture:d,section:d,a:oe,audio:j,b:z,base:ae,blockquote:ue,br:pe,code:w,dir:q,dl:de,dt:M,dd:M,del:A,em:k,h1:g,h2:g,h3:g,h4:g,h5:g,h6:g,hr:me,i:k,iframe:ye,img:H,image:H,input:Se,kbd:w,li:M,listing:x,mark:k,ol:q,p:P,plaintext:x,pre:x,q:Ae,s:A,samp:w,select:qe,strike:A,strong:z,summary:P,table:Re,td:L,textarea:Oe,th:L,tr:Ue,tt:w,u:k,ul:q,var:w,video:j,wbr:je,xmp:x};function u(e,t){return e.all(t)}function d(e,t){return e.toFlow(e.all(t))}function p(){}const E={}.hasOwnProperty;function Le(e){return{all:We,baseFound:!1,elementById:new Map,frozenBaseUrl:void 0,handlers:{...ze,...e.handlers},inTable:!1,nodeHandlers:{...Pe,...e.nodeHandlers},one:Ee,options:e,patch:Ke,qNesting:0,resolve:Qe,toFlow:Xe,toSpecificContent:De}}function We(e){const t=e.children||[],n=[];let r=-1;for(;++r<t.length;){const l=t[r],i=this.one(l,e);Array.isArray(i)?n.push(...i):i&&n.push(i)}return n}function Ee(e,t){if(e.type==="element"){if(e.properties&&e.properties.dataMdast==="ignore")return;if(E.call(this.handlers,e.tagName))return this.handlers[e.tagName](this,e,t)||void 0}else if(E.call(this.nodeHandlers,e.type))return this.nodeHandlers[e.type](this,e,t)||void 0;if("value"in e&&typeof e.value=="string"){const n={type:"text",value:e.value};return this.patch(e,n),n}if("children"in e)return this.all(e)}function Ke(e,t){e.position&&(t.position=ne(e))}function Qe(e){const t=this.frozenBaseUrl;return e==null?"":t?String(new URL(e,t)):e}function Xe(e){return _(e)}function De(e,t){const n=t(),r=[];let l=[],i=-1;for(;++i<e.length;){const s=e[i];if(o(s))l.length>0&&(s.children.unshift(...l),l=[]),r.push(s);else{const c=s;l.push(c)}}if(l.length>0){let s=r[r.length-1];s||(s=t(),r.push(s)),s.children.push(...l),l=[]}return r;function o(s){return s.type===n.type}}const Ge={};function K(e,t){const n=X(e),r=t||Ge,l=re({newlines:r.newlines===!0}),i=Le(r);let o;l(n),N(n,function(c){if(c&&c.type==="element"&&c.properties){const a=String(c.properties.id||"")||void 0;a&&!i.elementById.has(a)&&i.elementById.set(a,c)}});const s=i.one(n,void 0);return s?Array.isArray(s)?o={type:"root",children:s}:o=s:o={type:"root",children:[]},N(o,function(c,a,h){if(c.type==="text"&&a!==void 0&&h){const f=h.children[a-1];if(f&&f.type===c.type)return f.value+=c.value,h.children.splice(a,1),f.position&&c.position&&(f.position.end=c.position.end),a-1;if(c.value=c.value.replace(/[\t ]*(\r?\n|\r)[\t ]*/,"$1"),h&&(h.type==="heading"||h.type==="paragraph"||h.type==="root")&&(a||(c.value=c.value.replace(/^[\t ]+/,"")),a===h.children.length-1&&(c.value=c.value.replace(/[\t ]+$/,""))),!c.value)return h.children.splice(a,1),a}}),o}const Q={document:!0};function nt(e,t){return e&&"run"in e?async function(n,r){const l=K(n,{...Q,...t});await e.run(l,r)}:function(n){return K(n,{...Q,...e})}}export{nt as default};
